... (arrived a bit late) #CBH Check slideshow!

#### Time Stamp Service by trusted third party
"Trent" is public notary 

**Requirements:**
1. Data itself must be timestamped
2. Must be impossible to change a single bit of the document without change being apparent
3. Must be impossible to timestamp a document with a date and time different from the present one.

"First Attempt" <-?
- Alice transmits document to Trent
- Trend records data and time he received the document and retains copy for safekeeping

Problems:
- Privacy: document, even encrypted has to sit in Trent's database
- Database will be large, and bandwidth to send large documents will be wasted
- If third party in Trent's absence, they can collude with Alice and modify timestamp

Improved solution with one-way hash:
1. Alice produces a one-way hash of the document
2. Alice transmits the hash to Trent
3. Trent appends the date and time he received the hash onto the hash and digitally signs the result
4. Trent sends the signed hash with timestamp back to Alice.

The problem is that Alice can still collude with Trent and put a false hash
The **solution** is to link the timestamp with timestamps previously generated by other clients (linked list). This "sandwiches" Alice's request in time between previous and next requests.

#### Subliminal Channel
- Alice and Bob have been arrested and going to separate prisons
- Walter (the warden) agrees to let Alice and Bob exchange messages.
- Walter is suspicious and wants to read all their messages. Walter also wants to deceive them and have them accept fraudulent messages as from each other.
- Alice and Bob *must* accept the risk of deception, otherwise they can not communicate and coordinate their plans.
- They set up a **subliminal channel** (a covert communication channel) in full view of Walter. E.gs:
	- Subliminal channel may be the number of words in a sentence. This has no key, and the algorithm has to be secret.
	- Idea: hide subliminal channel in the digital signature. Using a secret key (previously shared with Bob), Alice signs the innocuous message and the subliminal channel is via the signature.

To implement this idea, we can use the El Gamal digital signature (we'll come back to this later on)

#### Group Signature - emphasis on privacy
- To control excessive use of resources
- In vehicular networks, to be able to send warning message about road conditions
Requirements:
1. Only members of the group can sign messages.
2. The receiver of the signature can verify that it is a valid signature from the group.
3. The receiver of the signature can not determine which member of the group is the signer.
4. In the case of a dispute, the signature can be opened to reveal the identity of the signer.
These did not come to full fruition because it didn't make money (just simply for public good)

To make this work, we can have a trusted third party ("Trent")
Tent gives each group member a different list with private keys
No two keys on any list can be the same.
Trent publishes the *master* list of public keys for the group in random order.
- Trent keeps information about key pairs secret.
When group member wants to sign they choose private key from their list.
When someone wants to verify whether that signature belongs to a group member they look for corresponding public key in the **master list**.
In the case of a dispute, Trent knows which public key corresponds to which group member.

At the end of the day, a pretty expensive algorithm.

### Undeniable digital signature; "non-transferable digital signature"
- Idea: such signature can not be verified without signer's consent (*non-transferable*)
- Alice's company distributes software "DEW"
- To ensure that software is virus free, they include a signature to each copy
- Ideally, only legal buyers, not software pirates should be able to verify the signature.
- Algorithm sketch: Bob has to validate signature that Alice sends:
	1. Alice presents Bob with signature
	2. Bob generates random number and sends to Alice
	3. Alice does a calculation with that random number and her private key. (Alice can do this ONLY if the signature is legit). Alice sends Bob the result
	4. Bob confirms.

##### The math:
#CBH What the cuss is going on here?
p: large prime number
g: generator
^ Both made public and can be used by a group of signers
Alice has a private key x and public key $Y=g^x\ mod\ p$
- To sign a message m, Alice computes $z=m^x\ mod\ p$
Verification by Bob:
1. Bob generates two random numbers a and b < p and sends to Alice the following construct:
	- $c = z^a(g^x)^b\ mod\ p$
2. Alice computes $t=x^{-1}\ mod\ p$ so that $t=x^{\phi(p)-1}\ mod\ p$ , $t*x\ mod\ p = 1$
	- Therefore, $t*x=k*p+1$
3. So Alice sends bob: $d = c^t\ mod\ p$
4. Bob confirms that $d=m^ag^b\ mod\ p$
	- $d=z^{at}(g^x)^bt\ mod\ p = m^{xta}g^{bxt}\ mod\ p$
(pg. 537 in Schneier) <-- Good idea to figure out if page numbers are different.

